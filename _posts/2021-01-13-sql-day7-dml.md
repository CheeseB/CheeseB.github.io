---
title: "[SQL] Day7 - DML"
categories:
- sql
tags:
- sql
- oracle
- database
classes: wide
---


## DML(Data Manipulation Language: 데이터 조작어)


### INSERT 

- INSERT: 테이블에 데이터를 입력하기 위한 조작어
	- 한번에 하나의 행을 입력하는 것이 기본
	- 서브쿼리를 이용해 한번에 여러행 동시입력 가능

```sql
INSERT INTO 테이블명(컬럼명)
VALUES(값)
```

- 주의사항
	- INTO 절의 컬럼에 VALUES 절의 컬럼값을 일대일 대응하여 입력
	- INTO 절에 컬럼명을 생략하면 테이블의 컬럼순서와 동일한 순서로 입력됨
	- 데이터타입을 동일하게 해야하며, 데이터의 크기가 컬럼 크기보다 작아야함
	- 문자, 날짜는 반드시 작은따옴표 쓰기


```sql
INSERT INTO dept(deptno, dname, loc)
VALUES(90, '인사과', '서울');

-- 원래 테이블의 순서와 달라도 상관없음
INSERT INTO dept(loc, dname, deptno)
VALUES('서울', '인사과', 70);

INSERT INTO dept
VALUES(80, '인사과', '서울');
```

- 데이터에 null값도 입력 가능
	- 묵시적 방법: 컬럼명과 값 생략
		- INTO 절과 VAULE 절 둘다 생략해야됨 (하나만 생략하면 에러)
	- 명시적 방법: 값에 null 키워드를 적거나 빈 문자열('') 사용
		- null을 직접 쓰는것을 권장
- not null 제약조건이 지정된 컬럼은 불가 (ex. Primary Key)

```sql
-- 묵시적
INSERT INTO dept(deptno, dname)
VALUES(91, '인사과');

-- 명시적
INSERT INTO dept
VALUES(92, '인사과', null);

INSERT INTO dept
VALUES(92, '인사과', '');
```

- 특수값 입력 가능 (USER, SYSDATE)

```sql
INSERT INTO emp(empno, ename, job, mgr, hiredate, sal, comm, deptno)
VALUES(9000, USER, '연구원', 7839, SYSDATE, 5000, NULL, 90);
```

- 특정 데이터타입 입력(RR/MM/DD, TO_DATE())

```sql
INSERT INTO emp
VALUES(9001, '홍길동', 'MANAGER', 7839, '2000/01/01', 2000, NULL, 30);
-- 날짜에 TO_DATE('2000-01-01', 'YYYY/MM/DD') 해도 됨
```

- 다중 행 입력

```sql
-- emp로부터 열 두개만 카피한 비어있는 테이블 생성
-- 제약조건은 카피 안됨
CREATE TABLE copy_emp
AS
SELECT empno, ename
FROM emp
WHERE 1=2;

-- emp로부터 선택한 여러 행을 테이블에 삽입
INSERT INTO copy_emp(empno, ename)
SELECT empno, ename
FROM emp;
```

- 다중 테이블 다중 행 입력
	- 무조건 INSERT ALL: 명시된 테이블 모두에 넣음
	- 조건 INSERT ALL: 조건을 만족하는 테이블 모두에 넣음
	- 조건 INSERT FIRST: 가장 먼저 만족하는 조건에 넣고, 이후의 조건은 만족해도 넣지 않음 (if문과 동일)

```sql
-- 무조건 INSERT ALL
INSERT ALL
INTO sal_history VALUES(empno, hiredate, sal)
INTO mgr_history VALUES(empno, mgr, sal)
SELECT empno, hiredate, mgr, sal FROM emp;

-- 조건 INSERT ALL
INSERT ALL
WHEN sal < 2500 THEN
    INTO sal_history VALUES(empno, hiredate, sal)
WHEN sal > 2500 THEN
    INTO mgr_history VALUES(empno, mgr, sal)
SELECT empno, hiredate, sal, mgr
FROM emp;

-- 조건 INSERT FIRST
INSERT FIRST
WHEN sal = 800 THEN
    INTO sal_history VALUES(empno, hiredate, sal)
WHEN sal < 2500 THEN
    INTO mgr_history VALUES(empno, mgr, sal)
ELSE
    INTO test_history VALUES(empno, sal)
SELECT empno, hiredate, sal, mgr
FROM emp;
```
